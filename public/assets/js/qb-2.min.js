/*! qb 28-03-2019 */

function initializeJS(){function a(a,b){var c=a.itemName,d=0,e=a.lotNo,f=a.mrp,g=a.taxPercent,h=a.availableQty,i=$("#tBodyowItems tr").length,j=(a.upp,a.mOq),k=a.cno,l=(1*parseFloat(j)).toFixed(2),m=$("#customerType").val();if($("#editKey").length>0)var n=$("#editKey").val();else var n=0;if($("#paymentMethodWindow, #customerWindow, #owItemsTable, #saveWindow, #tFootowItems, #remarksWindow").show(),"b2c"===m?$("#siOtherInfoWindow").hide():"b2b"===m?$("#siOtherInfoWindow").show():$("#siOtherInfoWindow").hide(),$("#tr_"+b).length>0){var o=$("#tr_"+b+" .saleItemQty").val(),p=parseFloat(o)+parseFloat(l);$("#tr_"+b+" .saleItemQty").val(p.toFixed(2))}else{d=0==i?1:i+1;var q=taxableAmount=parseFloat(1*f).toFixed(2),r='<tr id="tr_'+b+'" class="bcRow" index="'+d+'">',s='<td align="right" style="vertical-align:middle;" class="itemSlno">'+d+"</td>",t='<td style="vertical-align:middle;"><input type="text" name="itemDetails[itemName][]" id="iname_'+d+'" class="saleItem noEnterKey" index="'+d+'"  value="'+c+'" style="width:190px;" readonly/></td>',u='<td style="vertical-align:middle;"><input type="text" class="form-control lotNo" name="itemDetails[lotNo][]" id="lotNo_'+d+'" index="'+d+'" value="'+e+'"  readonly />';u+=""!==k?'<span style="font-size:11px;text-align:center;font-weight:bold;color:#FC4445">CASE: '+k+"</span></td>":"</td>";var v='<td style="vertical-align:middle;"><input type="text" class="qtyAvailable text-right noEnterKey" name="itemDetails[itemAvailQty][]" id="qtyava_'+d+'" index="'+d+'" value="'+h+'"  readonly  size="10" /></td>',w='<td style="vertical-align:middle;"><input type="text" class="form-control saleItemQty noEnterKey" name="itemDetails[itemSoldQty][]" id="qty_'+d+'" index="'+d+'" value="'+l+'" style="text-align:right;font-weight:bold;font-size:14px;border:1px dashed;" /></td>',x='<td style="vertical-align:middle;"><input type="text" class="mrp text-right noEnterKey" name="itemDetails[itemRate][]" id="mrp_'+d+'" index="'+d+'" value="'+f+'" size="10"';0===parseInt(n)&&(x+=" readonly"),x+=" /></td>";var q='<td class="grossAmount" id="grossAmount_'+d+'" index="'+d+'" style="vertical-align:middle;text-align:right;">'+q+"</td>",y='<td style="vertical-align:middle;"><input type="text" name="itemDetails[itemDiscount][]" id="discount_'+d+'" size="10" class="saDiscount noEnterKey"  index="'+d+'"  /></td>',z='<td class="taxableAmt text-right" id="taxableAmt_'+d+'" index="'+d+'" style="vertical-align:middle;text-align:right;">'+taxableAmount+"</td>",A='<td style="vertical-align:middle;"><input type="text" name="itemDetails[itemTaxPercent][]" id="saItemTax_'+d+'" size="10" class="form-control saItemTax noEnterKey"  index="'+d+'" value="'+g+'"  /></td>',B='<td style="vertical-align:middle;text-align:center;"><div class="btn-actions-group"><a class="btn btn-danger deleteOwItem" href="javascript:void(0)" title="Delete Row" id="delrow_'+b+'"><i class="fa fa-times"></i></a></div></td>',C='<input type="hidden" class="taxAmount" id="taxAmount_'+d+'" value="" />',D='<input type="hidden" class="itemType" id="itemType_'+d+'" value="" />',E=r+s+t+u+v+w+x+q+y+z+A+B+C+D+"</tr>";$("#tBodyowItems").append(E)}$(".saleItemQty").trigger("change")}function b(a,b){var c=a.itemName,d=0,e=a.lotNo,f=a.mrp,g=(a.taxPercent,a.lc),h=(a.upp,a.mOq),i=(1*parseFloat(h)).toFixed(2);if($("#loc_"+g).length>0)var j=$("#loc_"+g).val();else var j="";var k=(a.availableQty,$("#tBodyowItems tr").length);if($("#customerWindow, #owItemsTable, #saveWindow, #tFootowItems").show(),$("#tr_"+b).length>0){var l=$("#tr_"+b+" .saleItemQty").val(),m=parseFloat(l)+parseFloat(i);$("#tr_"+b+" .saleItemQty").val(m.toFixed(2))}else{d=0==k?1:k+1;var n=taxableAmount=parseFloat(1*f).toFixed(2),o='<tr id="tr_'+b+'" class="bcRow" index="'+d+'">',p='<td align="right" style="vertical-align:middle;" class="itemSlno">'+d+"</td>",q='<td style="vertical-align:middle;"><input type="text" name="itemDetails[itemName][]" id="iname_'+d+'" class="saleItem noEnterKey" index="'+d+'"  value="'+c+'" style="width:190px;" readonly/></td>',r='<td style="vertical-align:middle;"><input type="text" class="form-control lotNo" name="itemDetails[lotNo][]" id="lotNo_'+d+'" index="'+d+'" value="'+e+'"  readonly /></td>',s='<td style="vertical-align:middle;"><input type="text" class="form-control saleItemQty noEnterKey" name="itemDetails[itemSoldQty][]" id="qty_'+d+'" index="'+d+'" value="'+i+'" style="text-align:right;font-weight:bold;font-size:14px;border:1px dashed;" readonly="readonly" /></td>',t='<td style="vertical-align:middle;"><input type="text" class="mrp text-right noEnterKey" name="itemDetails[itemRate][]" id="mrp_'+d+'" index="'+d+'" value="'+f+'" size="10" /></td>',n='<td class="grossAmount" id="grossAmount_'+d+'" index="'+d+'" style="vertical-align:middle;text-align:right;">'+n+"</td>",u='<td style="vertical-align:middle;text-align:center;"><div class="btn-actions-group"><a class="btn btn-danger deleteOwItem" href="javascript:void(0)" title="Delete Row" id="delrow_'+b+'"><i class="fa fa-times"></i></a></div></td>',v='<input type="hidden" class="noEnterKey" name="itemDetails[barcode][]" id="barcode_'+d+'" index="'+d+'" value="'+b+'" size="13" />',w=o+p+q+r+s+t+n+u+v+"</tr>";$("#tBodyowItems").append(w)}$("#locationCode").val(j),$(".saleItemQty").trigger("change")}function c(a){var b=(totTaxAmount=0,roundedNetPay=netPay=0,parseFloat(returnNumber(jQuery("#qty_"+a).val()))),c=parseFloat(returnNumber(jQuery("#mrp_"+a).val())),e=parseFloat(returnNumber(jQuery("#saItemTax_"+a).val())),f=parseFloat(c*b).toFixed(2),g=(f*e/100).toFixed(2);$("#itemType_"+a).val();$("#taxAmount_"+a).val(g),$("#grossAmount_"+a).text(f),$("#saItemTax_"+a+' option[value="'+e+'"]').attr("selected","selected"),d()}function d(){var a=totTaxableAmount=totDiscount=totTaxAmount=0,b=(roundedNetPay=netPay=0,insuranceCharges=otherCharges=0),c=$("#taxCalcOption").val();jQuery(".grossAmount").each(function(b,c){iTotal=returnNumber(parseFloat(jQuery(this).text())),a+=iTotal}),"i"===c?totTaxAmount=0:jQuery(".taxAmount").each(function(a,b){iTotal=returnNumber(parseFloat(jQuery(this).val())),totTaxAmount+=iTotal}),$("#grossAmount").text(parseFloat(a).toFixed(2)),$("#gstAmount").text(parseFloat(totTaxAmount).toFixed(2)),netPay=parseFloat(a+totTaxAmount+b+insuranceCharges+otherCharges),roundedNetPay=Math.round(netPay),roundOff=(parseFloat(roundedNetPay)-netPay).toFixed(2),$("#roundOff").text(roundOff),$("#netPayTop").val(roundedNetPay.toFixed(2)),$("#netPayBottom").text(roundedNetPay.toFixed(2))}function e(a){var b=totalTaxAmount=finalAmount=0,c=roundedNetPay=0,d=parseFloat(returnNumber($("#inwRcvdQty_"+a).val())),e=parseFloat(returnNumber($("#inwFreeQty_"+a).val())),g=parseFloat(returnNumber($("#inwItemRate_"+a).val())),h=parseFloat(returnNumber($("#inwItemDiscount_"+a).val())),i=parseFloat(returnNumber($("#inwItemTax_"+a).val())),j=parseFloat(returnNumber($("#packed_"+a).val())),k=(d-e)*j,l=parseFloat(returnNumber(k*g)),m=parseFloat(returnNumber(l-h)),n=parseFloat(m*i/100).toFixed(2),o=returnNumber(parseFloat($("#packingCharges").val())),p=returnNumber(parseFloat($("#shippingCharges").val())),q=returnNumber(parseFloat($("#insuranceCharges").val())),r=returnNumber(parseFloat($("#otherCharges").val()));$("#inwBillQty_"+a).val(k),$("#inwItemGrossAmount_"+a).val(l),$("#inwItemAmount_"+a).val(m),$("#inwItemTaxAmt_"+a).val(n),jQuery(".inwItemAmount").each(function(a,c){0===jQuery(this).val().length?iTotal=0:iTotal=parseFloat(returnNumber(jQuery(this).val())),iTotal>0&&(b+=iTotal)}),jQuery(".inwItemTaxAmount").each(function(a,b){0===jQuery(this).val().length?iTotal=0:iTotal=parseFloat(returnNumber(jQuery(this).val())),iTotal>0&&(totalTaxAmount+=iTotal)}),c=parseFloat(b+totalTaxAmount)+parseFloat(o)+parseFloat(p)+parseFloat(q)+parseFloat(r),roundedNetPay=Math.round(c),finalAmount=c-parseFloat(roundedNetPay.toFixed(2)),$("#inwItemsTotal").text(b.toFixed(2)),$("#inwItemTaxAmount").text(totalTaxAmount.toFixed(2)),$("#roundOff").text(finalAmount.toFixed(2)),$("#inwNetPay").text(roundedNetPay),f()}function f(){jQuery(".inwTaxPercents").each(function(a,b){var c=$(this).val(),d=$(this).attr("id"),e=totalTaxable=0;if($("input[data-rate='"+c+"']").each(function(a,b){if(parseFloat(returnNumber($(this).val()))>0){var c=$(this).attr("id").split("_"),d=c[1],f=$("#inwItemAmount_"+d).val();totalTaxable=(parseFloat(totalTaxable)+parseFloat(f)).toFixed(2),e=(parseFloat(e)+parseFloat($(this).val())).toFixed(2)}}),$("#taxAmount_"+d).val(e.toFixed(2)),"inter"===$("#supplyType").val())$("#taxable_"+d+"_igst_value").text(parseFloat(e).toFixed(2)),$("#taxable_"+d+"_cgst_value").text(""),$("#taxable_"+d+"_sgst_value").text("");else{var f=parseFloat(e/2).toFixed(2);$("#taxable_"+d+"_cgst_value").text(f),$("#taxable_"+d+"_sgst_value").text(f),$("#taxable_"+d+"_igst_value").text("")}$("#taxable_"+d+"_amount").text(totalTaxable)})}function g(a){var b=(totTaxableAmount=totDiscount=totTaxAmount=0,roundedNetPay=netPay=0,parseFloat(returnNumber(jQuery("#qty_"+a).val()))),c=parseFloat(returnNumber(jQuery("#mrp_"+a).val())),d=parseFloat(returnNumber(jQuery("#discount_"+a).val())),e=parseFloat(returnNumber(jQuery("#saItemTax_"+a).val())),f=parseFloat(c*b).toFixed(2),g=parseFloat(f-d).toFixed(2),i=(g*e/100).toFixed(2);$("#itemType_"+a).val();$("#taxAmount_"+a).val(i),$("#grossAmount_"+a).text(f),$("#taxableAmt_"+a).text(g),h()}function h(){var a=totTaxableAmount=totDiscount=totTaxAmount=0,b=(roundedNetPay=netPay=0,0),c=e=f=0,d=returnNumber(parseFloat($("#packingCharges").val())),c=returnNumber(parseFloat($("#shippingCharges").val())),e=returnNumber(parseFloat($("#insuranceCharges").val())),f=returnNumber(parseFloat($("#otherCharges").val())),g=$("#taxCalcOption").val();jQuery(".grossAmount").each(function(b,c){iTotal=returnNumber(parseFloat(jQuery(this).text())),a+=iTotal}),jQuery(".saDiscount").each(function(a,b){iTotal=returnNumber(parseFloat(jQuery(this).val())),totDiscount+=iTotal}),jQuery(".taxableAmt").each(function(a,b){iTotal=returnNumber(parseFloat(jQuery(this).text())),totTaxableAmount+=iTotal}),jQuery(".saleItemQty").each(function(a,c){var d=jQuery(this).attr("index");""!==$("#iname_"+d).val()&&(qTotal=returnNumber(parseFloat(jQuery(this).val())),b+=qTotal)}),"i"===g?totTaxAmount=0:jQuery(".taxAmount").each(function(a,b){iTotal=returnNumber(parseFloat(jQuery(this).val())),totTaxAmount+=iTotal}),$("#grossAmount").text(parseFloat(a).toFixed(2)),$("#totDiscount").text(parseFloat(totDiscount).toFixed(2)),$("#taxableAmount").text(parseFloat(totTaxableAmount).toFixed(2)),$("#gstAmount").text(parseFloat(totTaxAmount).toFixed(2)),netPay=parseFloat(totTaxableAmount+totTaxAmount+d+c+e+f),roundedNetPay=Math.round(netPay),roundOff=(parseFloat(roundedNetPay)-netPay).toFixed(2),$("#roundOff").text(roundOff),$("#netPayTop").val(roundedNetPay.toFixed(2)),$("#netPayBottom").text(roundedNetPay.toFixed(2)),$("#totalItems").text(b.toFixed(2))}function i(){var a=roundOff=netPay=0;jQuery(".itemReturnValue").each(function(b,c){iTotal=jQuery(this).text(),parseFloat(iTotal)>0&&(a+=parseFloat(iTotal))}),roundOff=parseFloat(Math.round(a)-a),netPay=parseFloat(a+roundOff),jQuery(".totalAmount").text(a.toFixed(2)),jQuery(".roundOff").text(roundOff.toFixed(2)),jQuery(".netPay").text(netPay.toFixed(2))}if(jQuery(".date").datepicker(),jQuery("#timepicker1").timepicker(),jQuery(".tooltips").tooltip(),jQuery(".popovers").popover(),jQuery("html").niceScroll({styler:"fb",cursorcolor:"#007AFF",cursorwidth:"6",cursorborderradius:"10px",background:"#F7F7F7",cursorborder:"",zindex:"1000"}),jQuery("#sidebar").niceScroll({styler:"fb",cursorcolor:"#007AFF",cursorwidth:"3",cursorborderradius:"10px",background:"#F7F7F7",cursorborder:""}),jQuery(".scroll-panel").niceScroll({styler:"fb",cursorcolor:"#007AFF",cursorwidth:"3",cursorborderradius:"10px",background:"#F7F7F7",cursorborder:""}),jQuery("#sidebar .sub-menu > a").click(function(){var a=jQuery(".sub-menu.open",jQuery("#sidebar"));jQuery(this).find(".menu-arrow").removeClass("arrow_carrot-right"),jQuery(".sub",a).slideUp(200);var b=jQuery(this).next();b.is(":visible")?(jQuery(this).find(".menu-arrow").addClass("arrow_carrot-right"),b.slideUp(200)):(jQuery(this).find(".menu-arrow").addClass("arrow_carrot-down"),b.slideDown(200));var c=jQuery(this).offset();diff=200-c.top,diff>0?jQuery("#sidebar").scrollTo("-="+Math.abs(diff),500):jQuery("#sidebar").scrollTo("+="+Math.abs(diff),500)}),jQuery(function(){function a(){var a=jQuery(window).width();a<=768&&(jQuery("#container").addClass("sidebar-close"),jQuery("#sidebar > ul").hide()),a>768&&(jQuery("#container").removeClass("sidebar-close"),jQuery("#sidebar > ul").show())}jQuery(window).on("load",a),jQuery(window).on("resize",a)}),jQuery(".toggle-nav").click(function(){!0===jQuery("#sidebar > ul").is(":visible")?(jQuery("#main-content").css({"margin-left":"0px"}),jQuery("#sidebar").css({"margin-left":"-180px"}),jQuery("#sidebar > ul").hide(),jQuery("#container").addClass("sidebar-closed")):(jQuery("#main-content").css({"margin-left":"180px"}),jQuery("#sidebar > ul").show(),jQuery("#sidebar").css({"margin-left":"0"}),jQuery("#container").removeClass("sidebar-closed"))}),$(document).on("keypress keydown keyup",".noEnterKey",function(a){if(13==a.keyCode)return a.preventDefault(),!1}),$("#dfyDashboard").length>0&&$.post("/async/finyDefault",$("#dfyDashboard").serialize()),$("#checkAllOpBarcodes").length>0&&$("#checkAllOpBarcodes").on("click",function(a){var b=this;$(".requestedItem").each(function(a,c){$(b).prop("checked")?$(this).prop("checked",!0):$(this).prop("checked",!1)})}),$("#changeMrpForm").length>0&&$(".itemnames").Tabledit({url:"/async/change-mrp",editButton:!1,deleteButton:!1,hideIdentifier:!1,columns:{identifier:[1,"lotAndItem"],editable:[[2,"newMrp"]]},onDraw:function(){$('[name="newMrp"]').length>0&&$('[name="newMrp"]').attr("title","Add new MRP and Hit Enter to Save.")},onAjax:function(a,b){var c=new URLSearchParams(b),d=returnNumber(parseFloat(c.get("newMrp")));if(d>0){var e=c.get("lotAndItem");return d>returnNumber(parseFloat($("#om__"+e).text()))||(bootbox.alert({message:"New MRP should be greater than old MRP. If you want to reduce the current MRP, please use Promocodes or Discount option."}),!1)}},onSuccess:function(a,b,c){if("success"===a.status)var d=a.response.updateMessage;else if("failed"===a.status)var d="Error: "+a.errorcode+", "+a.errortext;else var d="Unknown Error.";bootbox.alert({message:d})}}),$("#stockAuditItems").length>0&&($("#itemnames").Tabledit({url:"/async/auditQty?locationCode="+$("#locationCode").val()+"&aC="+$("#aC").val(),editButton:!1,deleteButton:!1,hideIdentifier:!1,columns:{identifier:[1,"itemName"],editable:[[5,"phyQty"]]}}),$(".tabledit-input").on("keypress keydown keyup",function(a){13==a.keyCode&&a.preventDefault()}),$("#saLockSubmit").on("click",function(a){a.preventDefault(),bootbox.confirm("Are you sure. You want to Lock and Submit the Audit?",function(a){!0===a&&($("#stockAuditItems").append('<input type="hidden" name="op" value="saLockSubmit" />'),$(this).attr("disabled",!0),$("#stockAuditItems").submit())})}),$("#saPhyQty").on("click",function(a){a.preventDefault(),$("#stockAuditItems").append('<input type="hidden" name="op" value="saPhyQty" />'),$(this).html('<i class="fa fa-recycle"></i> Processing, Please Wait....'),$(this).attr("disabled",!0),$("#filterSubmit, #filterReset, #printAuditReport").attr("disabled",!0),$("#stockAuditItems").submit()}),$("#printAuditReport").on("click",function(a){a.preventDefault();var b=$("#aC").val();window.location.href="/stock-audit/print/"+b})),$("#owBarcode").length>0&&($("#customerType").on("change",function(a){if($("#tBodyowItems tr").length>0){var b=$(this).val();"b2c"===b?($("#siOtherInfoWindow").hide(),$("#packingCharges, #shippingCharges, #insuranceCharges, #otherCharges").val("")):"b2b"===b?($("#siOtherInfoWindow").show(),$("#name").addClass("cnameAc")):($("#siOtherInfoWindow").hide(),$("#packingCharges, #shippingCharges, #insuranceCharges, #otherCharges").val(""))}else $(this).val("b2c"),alert("Scan Barcode first.")}),$("#owBarcode").on("keypress",function(b){if(13==b.keyCode){var c=$(this).val();if(13!==c.length)return alert("Invalid barcode"),!1;var d=$("#locationCode").val();jQuery.ajax("/async/getItemDetailsByCode?bc="+c+"&locationCode="+d,{success:function(b){if("success"===b.status){Object.keys(b.response.bcDetails).length>0?(a(b.response.bcDetails,c),$("#owBarcode").val("")):alert("Barcode not found")}},error:function(a){alert("Barcode not found in the Selected store.")}}),b.preventDefault()}}),$("#tBodyowItems").on("click","a.deleteOwItem",function(a){var b=$(this).attr("id");bootbox.confirm("Are you sure. You want to remove this item?",function(a){if(!0===a&&""!==b){var c=b.split("_")[1],d=$("#tr_"+c);if(d.length>0)if(d.remove(),$("#tBodyowItems tr").length>0){var e=1;$(".itemSlno").each(function(a,b){$(this).text(e),e++}),$(".saleItemQty").trigger("change")}else $("#totalItems, #grossAmount, #totDiscount, #taxableAmount, #gstAmount, #roundOff, #netPayBottom").text(""),$("#paymentMethodWindow, #customerWindow, #splitPaymentWindow, #saveWindow, #owItemsTable, #siOtherInfoWindow, #remarksWindow").hide(),$("#owBarcode").val("")}})})),$(".transBarcode").length>0&&($(".transBarcode").on("blur",function(a){var b=$(this).val(),c=$(this).attr("id"),d=c.split("_")[1];""===b&&$("#iname_"+d).removeAttr("readonly")}),$(".transBarcode").on("keypress",function(a){if(13==a.keyCode){var b=$(this).val(),d=$(this).attr("id"),e=parseInt(d.split("_")[1]);if(13!==b.length)return alert("Invalid barcode"),!1;var f=$("#fromLocation").val();jQuery.ajax("/async/getItemDetailsByCode?bc="+b+"&locationCode="+f,{success:function(a){if("success"===a.status){if(Object.keys(a.response.bcDetails).length>0){var b=a.response.bcDetails.itemName,d=parseFloat(a.response.bcDetails.availableQty).toFixed(2),f=a.response.bcDetails.lotNo,g=a.response.bcDetails.cno,h=parseFloat(a.response.bcDetails.mOq).toFixed(2),i=parseFloat(a.response.bcDetails.taxPercent).toFixed(2),j=parseFloat(a.response.bcDetails.mrp).toFixed(2),k=parseFloat(1*h).toFixed(2),l=parseFloat(j*k).toFixed(2),m=$("#lotNo_"+e),n=!1;if(jQuery(".lotNo").each(function(a,b){selectedLotNo=$(this).val(),selectedLotNo===f&&e!==a&&(n=!0)}),n)$("#barcode_"+e).focus().val(""),alert("This Lot No. is already selected.  A Lot No. must be unique and selected only once against the same item.");else{$("#iname_"+e).attr("readonly","readonly"),$("#iname_"+e).val(b),$("#qtyava_"+e).val(d),$("#cno_"+e).text(g),$("#qty_"+e).val(k),$("#mrp_"+e).val(j),$("#grossAmount_"+e).text(l),$("#saItemTax_"+e+' option[value="'+i+'"]').attr("selected","selected"),$("#qtyava_"+e).attr("readonly","readonly"),$("#mrp_"+e).attr("readonly","readonly"),jQuery(m).html(jQuery("<option></option>").attr("value",f).text(f)),c(e);var o=e+1;$("#barcode_"+o).focus()}}else alert("Barcode not found")}},error:function(a){alert("Barcode not found in the Selected store.")}}),a.preventDefault()}})),$("#stBarcode").length>0&&$("#stBarcode").on("keypress",function(a){if(13==a.keyCode){var b=$(this).val();if(13!==b.length)return alert("Invalid barcode"),!1;var c=$("#locationCode").val(),d=$("#transferCode").val(),e=0,f=parseFloat($("#trTransQty").text());e<f?jQuery.ajax("/async/getTrDetailsByCode?barcode="+b+"&locationCode="+c+"&transferCode="+d,{beforeSend:function(){$("#stBarcode").attr("disabled",!0),$("#stBarcode").val("Validating Barcode. Please wait...")},success:function(a){if("success"===a.status){e+=parseFloat(a.qty),f=parseFloat($("#trTransQty").text());var b=parseFloat(f-e);if(0==b)$("#stBarcode").attr("disabled",!0),bootbox.alert({message:"Scanning completed. Click on Save Button / స్కానింగ్ పూర్తి ఐనది. ఈ బదిలీ సేవ్ చేయటానికి అంగీకరణ బటన్ ప్రెస్ చెయ్యండి."}),$("#stBarcode").val(""),$("#trScannedQty").text(e.toFixed(2)),$("#trDiff").text(b.toFixed(2));else if(b<0){$("#stBarcode").attr("disabled",!0);alert("Scanned Qty. is more than actual Transfer Qty. and it is invalid. Please Rescan Again / స్కాన్ చేసిన సరుకు అసలు ట్రాన్స్ఫర్ చేయబడిన సరుకు కన్నా ఎక్కువగా ఉన్నది. ఇది చెల్లదు. మీరు మరల సరి చూసుకొని స్కాన్ చేయ గలరు."),$("#transferCode").length>0?window.location.href="/stock-transfer/validate/"+$("#transferCode").val():window.location.href="/stock-transfer/list"}else $("#trScannedQty").text(e.toFixed(2)),$("#trDiff").text(b.toFixed(2)),$("#stBarcode").attr("disabled",!1),$("#stBarcode").val(""),$("#stBarcode").focus()}else bootbox.alert({message:a.error}),$("#stBarcode").attr("disabled",!1),$("#stBarcode").val(""),$("#stBarcode").focus()},error:function(a){bootbox.alert({message:"Barcode not found in this transfer. Please check. / మీరు స్కాన్ చేసిన బార్ కోడ్ ఈ ట్రాన్స్ఫర్ ఆర్డర్  లో లేదు. దయచేసి సరి చూసుకోండి."}),$("#stBarcode").attr("disabled",!1),$("#stBarcode").val(""),$("#stBarcode").focus()}}):bootbox.alert({message:"Scanning completed already. Click on Save Button / స్కానింగ్ పూర్తి ఐనది. ఈ బదిలీ సేవ్ చేయటానికి అంగీకరణ బటన్ ప్రెస్ చెయ్యండి."}),a.preventDefault()}}),$("#indentBarcode").length>0&&($(".messageContainer").length>0&&$(".messageContainer").fadeOut(5e3),$("#indentBarcode").on("keypress",function(a){if(13==a.keyCode){var c=$(this).val(),d=$("#locationCode").val();jQuery.ajax("/async/getItemDetailsByCode?bc="+c+"&locationCode="+d+"&sl=true&ind=true",{success:function(a){if("success"===a.status){if(Object.keys(a.response.bcDetails).length>0){if(a.response.bcDetails.availableQty<=0)return alert("Qty. not available"),$("#indentBarcode").focus(),$("#indentBarcode").val(""),!1;b(a.response.bcDetails,c),$("#indentBarcode").val("")}else alert("Barcode not found")}},error:function(a){}}),a.preventDefault()}}),$("#tBodyowItems").on("click","a.deleteOwItem",function(a){var b=$(this).attr("id");bootbox.confirm("Are you sure. You want to remove this item?",function(a){if(!0===a&&""!==b){var c=b.split("_")[1],d=$("#tr_"+c);if(d.length>0)if(d.remove(),$("#tBodyowItems tr").length>0){var e=1;$(".itemSlno").each(function(a,b){$(this).text(e),e++}),$(".saleItemQty").trigger("change")}else $("#totalItems, #grossAmount, #totDiscount, #taxableAmount, #gstAmount, #roundOff, #netPayBottom").text(""),$("#paymentMethodWindow, #customerWindow, #splitPaymentWindow, #saveWindow, #owItemsTable").hide(),$("#owBarcode").val("")}})})),$("#salesIndentMobileV").length>0){var j=[];$("#mobileIndentItem").on("click",function(a){a.preventDefault();var b=jQuery("#itemName").val(),c=jQuery("<option></option>").attr("value","").text("Choose");if(""!==b){var d={itemName:b};jQuery.ajax("/async/getItemBatchesByCode",{data:d,method:"POST",success:function(a){if("success"===a.status){var b=Object.keys(a).length,d=jQuery("#lotNo");b>0&&(d.empty().append(c),jQuery.each(a.response.bcDetails,function(a,b){j[b.lotNo]=b,jQuery(d).append(jQuery("<option></option>").attr("value",b.lotNo).text(b.mOq+" [ Available: "+b.availableQty+" ]"))}),$(".itemOtherInfo, .formButtons").show())}else alert("Item not available.")},error:function(a){alert("An error occurred while fetching Available Qty.")}})}else 0===parseInt(b.length)&&alert("Item name required.")}),$(".indentOrderQty").on("blur",function(a){var b=jQuery("#lotNo").val(),c=returnNumber(parseFloat($("#orderQty").val()));if(b in j&&c>0){var d=returnNumber(parseFloat(j[b].availableQty)),e=returnNumber(parseFloat(j[b].mOq)),f=returnNumber(parseFloat(j[b].mrp));if((c=returnNumber(parseFloat(c*e).toFixed(2)))>d)return alert("Order Qty. must be less than or equal to available Qty."),$(this).val(""),$(this).focus(),!1;$("#mrp").val(f),$("#orderQty").val(c)}})}if($(".cancelButton").on("click",function(a){a.preventDefault(),$(this).attr("disabled",!0),$(".cancelOp").attr("disabled",!0);var b=$(this).attr("id");console.log("hello"),"stoCancel"===b?window.location.href="/stock-transfer/choose-location":"inwBulkUploadCancel"===b?window.location.href="/inward-entry/bulk-upload":"seWithBarcode"===b?window.location.href="/sales/entry-with-barcode":"seWoBarcode"===b?window.location.href="/sales/entry":"ieWithBarcode"===b?window.location.href="/sales-indent/create":"uploadCustomers"===b?window.location.href="/upload-debtors":"uploadSuppliers"===b?window.location.href="/upload-creditors":"validateStButton"===b?window.location.href="/stock-transfer/register":"shippingPage"===b?window.location.href="/sales/list":"stransfer"===b&&(window.location.href="/stock-transfer/register")}),jQuery(".delPcVoucher").on("click",function(a){a.preventDefault();var b=jQuery(this).attr("href");bootbox.confirm("Are you sure. You want to remove this Voucher?",function(a){!0===a&&(window.location.href=b)})}),$(".delAdjEntry").length>0&&jQuery(".delAdjEntry").on("click",function(a){a.preventDefault();var b=jQuery(this).attr("href");bootbox.confirm("Are you sure. You want to remove this adjustment entry?",function(a){!0===a&&(window.location.href=b)})}),$("#searchPurchaseBills").length>0&&$("#searchBy").on("change",function(a){"itemname"===$(this).val()?($("#svProducts").show(),$("#svAll").hide()):($("#svProducts").hide(),$("#svAll").show()),$("#searchValue, #searchValueP").val("")}),$("#stockOutForm").length>0){var j=[];jQuery(".saleItem").on("blur",function(a){var b=jQuery(this).val(),c=jQuery(this).attr("index"),d=$("#lotNo_"+c),e=jQuery("<option></option>").attr("value","").text("Choose");if(""!==b){var f=$("#fromLocation").val(),g={itemname:b,locationCode:f};jQuery.ajax("/async/getAvailableQty",{data:g,method:"POST",success:function(a){if("success"===a.status){Object.keys(a).length>0?(jQuery(d).empty().append(e),jQuery.each(a.response,function(a,b){var c=b.cno,e=b.lotNo;""!==c&&(e+=" [ CASE: "+c+" ]"),j[b.lotNo]=b,jQuery(d).append(jQuery("<option></option>").attr("value",b.lotNo).text(e))})):jQuery(uppElement).text("")}},error:function(a){alert("An error occurred while fetching Batch Nos.")}})}else 0===parseInt(b.length)&&(jQuery(d).empty().append(e),jQuery("#qtyava_"+c).val(""),jQuery("#mrp_"+c).val(""),jQuery("#itemType_"+c).val(""),jQuery("#saItemTax_"+c+' option[value=""]').attr("selected","selected"),jQuery("#qty_"+c+' option[value="0"]').attr("selected","selected"))}),jQuery(".lotNo").on("change",function(a){var b=(itemRate=itemType="",jQuery(this).attr("index")),d=jQuery(this).val();jQuery("#qtyava_"+b),jQuery("#mrp_"+b),jQuery("#itemType_"+b);""!==d&&Object.keys(j[d]).length>0&&(jQuery("#qtyava_"+b).val(j[d].closingQty),jQuery("#qty_"+b).val(j[d].mOq),jQuery("#mrp_"+b).val(j[d].mrp),jQuery("#itemType_"+b).val(j[d].itemType),jQuery("#saItemTax_"+b+' option[value="'+j[d].taxPercent+'"]').attr("selected","selected"),c(b))}),jQuery(".saleItemQty").on("blur",function(){var a=parseInt($(this).val()),b=jQuery(this).attr("index"),d=$("#lotNo_"+b),e=jQuery("<option></option>").attr("value","").text("Choose");a>0?c(b):(jQuery(d).empty().append(e),jQuery("#qtyava_"+b).val(""),jQuery("#mrp_"+b).val(""),jQuery("#itemType_"+b).val(""),jQuery("#saItemTax_"+b+' option[value=""]').attr("selected","selected"),jQuery("#qty_"+b+' option[value="0"]').attr("selected","selected"),jQuery("#iname_"+b).val(""),jQuery("#grossAmount_"+b).text(""))})}if(jQuery(".inameAc").length>0&&$(".inameAc").autocomplete("/async/itemsAc",{width:300,cacheLength:0,selectFirst:!1,minChars:1,extraParams:{locationCode:function(){return $("#locationCode").length>0?$("#locationCode").val():$("#fromLocation").length>0?$("#fromLocation").val():""}},max:0}),jQuery(".brandAc").length>0&&$(".brandAc").autocomplete("/async/brandAc",{width:300,cacheLength:0,selectFirst:!1,minChars:1,extraParams:{locationCode:function(){return $("#locationCode").length>0?$("#locationCode").val():""}},max:0}),jQuery(".cnameAc").length>0&&$(".cnameAc").autocomplete("/async/custAc",{width:300,cacheLength:0,selectFirst:!1,minChars:1,max:0}),jQuery(".suppnameAc").length>0&&$(".suppnameAc").autocomplete("/async/suppAc",{width:300,cacheLength:0,selectFirst:!1,minChars:1,max:0}),$("#customerForm").length>0&&$("#customerType").on("change",function(){"b2b"===$(this).val()?($("#bioContainer").hide(),$("#age").val(0),$("#ageCategory").val("years"),$("#gender").val("")):$("#bioContainer").show()}),$("#editPOAfterGRN").length>0&&$("#grnDelete").on("click",function(a){a.preventDefault(),bootbox.confirm("Are you sure. You want to delete and re-create GRN for this PO?",function(a){!0===a&&($(this).attr("disabled",!0),$("#editPOAfterGRN").submit())})}),$("#grnEntryForm").length>0&&jQuery("#grnCancel").on("click",function(a){if(1!=confirm("Are you sure. You want to close this page?"))return!1;window.location.href="/grn/list",a.preventDefault()}),$("#inwardEntryForm").length>0&&(jQuery(".inwRcvdQty, .inwFreeQty, .inwItemRate, .inwItemDiscount").on("blur",function(a){e($(this).attr("id").split("_")[1])}),jQuery("#packingCharges, #shippingCharges, #insuranceCharges, #otherCharges").on("blur",function(a){var b=returnNumber(parseFloat($("#packingCharges").val())),c=returnNumber(parseFloat($("#shippingCharges").val())),d=returnNumber(parseFloat($("#insuranceCharges").val())),e=returnNumber(parseFloat($("#otherCharges").val())),f=totalTaxAmount=finalAmount=0,g=roundedNetPay=0;jQuery(".inwItemAmount").each(function(a,b){0===jQuery(this).val().length?iTotal=0:iTotal=parseFloat(returnNumber(jQuery(this).val())),iTotal>0&&(f+=iTotal)}),jQuery(".inwItemTaxAmount").each(function(a,b){0===jQuery(this).val().length?iTotal=0:iTotal=parseFloat(returnNumber(jQuery(this).val())),iTotal>0&&(totalTaxAmount+=iTotal)}),g=parseFloat(f+totalTaxAmount)+parseFloat(b)+parseFloat(c)+parseFloat(d)+parseFloat(e),roundedNetPay=Math.round(g),finalAmount=g-parseFloat(roundedNetPay.toFixed(2)),$("#inwItemsTotal").text(f.toFixed(2)),$("#inwItemTaxAmount").text(totalTaxAmount.toFixed(2)),$("#roundOff").text(finalAmount.toFixed(2)),$("#inwNetPay").text(roundedNetPay)}),jQuery(".inwItemTax").on("change",function(){var a=$(this).attr("id").split("_"),b=a[1];$("#inwItemTaxAmt_"+b).attr("data-rate",parseFloat($(this).val()).toFixed(2)),e(b)}),jQuery("#supplierID").on("change",function(a){var b=$(this).val();jQuery.ajax("/async/get-supplier-details?c="+b,{method:"GET",success:function(a){if("success"===a.status){var b=a.response.supplierDetails,c=$("#cs").val();$("#supplierState").val(b.stateCode),$("#supplierGSTNo").val(b.tinNo),c==b.stateCode?$("#supplyType").val("intra"):$("#supplyType").val("inter")}},error:function(a){alert("An error occurred while fetching Supplier Information.")}})}),jQuery("#inwCancel").on("click",function(a){if(1!=confirm("Are you sure. You want to close this page?"))return!1;window.location.href="/inward-entry/list",a.preventDefault()})),$("#outwardEntryForm").length>0){var j=[];$("#customerType").on("change",function(a){var b=$(this).val();"b2c"===b?($("#siOtherInfoWindow").hide(),$("#packingCharges, #shippingCharges, #insuranceCharges, #otherCharges").val("")):"b2b"===b?($("#siOtherInfoWindow").show(),$("#name").addClass("cnameAc")):($("#siOtherInfoWindow").hide(),$("#packingCharges, #shippingCharges, #insuranceCharges, #otherCharges").val(""))}),$("#SaveInvoice").on("click",function(a){a.preventDefault(),$(this).attr("disabled",!0),$(".cancelButton").attr("disabled",!0),$("#outwardEntryForm").submit()}),$("#saPaymentMethod").on("change",function(){var a=parseInt($(this).val());1===a||2===a?$("#containerCardNo, #containerAuthCode").show():3===a?($("#containerCrDays").show(),$("#containerCardNo, #containerAuthCode").hide()):$("#containerCardNo, #containerAuthCode, #containerCrDays").hide(),2===a?($("#splitPaymentWindow").show(),$("#splitPaymentCash, #splitPaymentCard, #splitPaymentCn, #cnNo").attr("disabled",!1),$("#containerCrDays").hide()):($("#splitPaymentCash, #splitPaymentCard, #splitPaymentCn, #cnNo").val(""),$("#splitPaymentCash, #splitPaymentCard, #splitPaymentCn, #cnNo").attr("disabled",!0),$("#splitPaymentWindow").hide())}),$("#saPromoCode").on("change",function(){""!==$(this).val()?($("#SaveInvoice").html("<i class='fa fa-lemon-o'></i> Apply Promo Code &amp; Continue"),$("#SaveInvoice").attr("class","btn btn-danger")):($("#SaveInvoice").html("<i class='fa fa-save'></i> Save &amp; Print"),
$("#SaveInvoice").attr("class","btn btn-primary"))}),jQuery(".saleItem").on("blur",function(a){var b=jQuery(this).val(),c=jQuery(this).attr("index"),d=$("#lotNo_"+c),e=jQuery("<option></option>").attr("value","").text("Choose");$(d).children("option").length;if(""!==b){var f=$("#locationCode").val();if(""==f)return alert("Please choose Store location first."),$("#hdg-reports").scrollTop(),document.getElementById("locationCode").focus(),!1;var g={itemname:b,locationCode:f};jQuery.ajax("/async/getAvailableQty",{data:g,method:"POST",success:function(a){Object.keys(a).length>0?(jQuery(d).empty().append(e),jQuery.each(a.response,function(a,b){j[b.lotNo]=b,jQuery(d).append(jQuery("<option></option>").attr("value",b.lotNo).text(b.lotNo+" [ Packing: "+b.mOq+" ]"))})):jQuery(uppElement).text("")},error:function(a){alert("An error occurred while fetching Batch Nos.")}})}}),jQuery(".lotNo").on("change",function(a){var b=(itemRate=itemType="",parseInt(jQuery(this).attr("index"))),c=jQuery(this).val();jQuery("#qtyava_"+b),jQuery("#mrp_"+b),jQuery("#itemType_"+b);if(""!==c&&Object.keys(j[c]).length>0){var d="";jQuery(".lotNo").each(function(a,e){if((d=$(this).val())===c&&b!==a)return $("#lotNo_"+b).val(""),bootbox.alert({message:"This Lot No. is already selected.  A Lot No. must be unique and selected only once in the bill against the same item."}),!1}),jQuery("#qtyava_"+b).val(j[c].closingQty),jQuery("#qty_"+b).val(j[c].mOq),jQuery("#mrp_"+b).val(j[c].mrp),jQuery("#itemType_"+b).val(j[c].itemType),jQuery("#saItemTax_"+b+' option[value="'+j[c].taxPercent+'"]').attr("selected","selected"),g(b)}}),$("#outwardEntryForm").on("blur",".saDiscount",function(a){g(jQuery(this).attr("index"))}),$("#outwardEntryForm").on("change",".taxCalcOption",function(){h()}),$("#outwardEntryForm").on("change",".saleItemQty",function(){g(jQuery(this).attr("index"))}),$("#outwardEntryForm").on("change",".mrp",function(){g(jQuery(this).attr("index"))}),$("#refCode").on("blur",function(a){var b=returnNumber($(this).val());parseInt(b)>0?jQuery.ajax("/async/get-ref-details?refCode="+b,{success:function(a){if($("#refCodeStatus").show(),"success"===a.status){var b=a.response.memberDetails,c=b.memberName,d=b.mobileNo;$("#refMemberName").val(c),$("#refMemberMobile").val(d),$("#refCodeStatus").html('<b style="color:green;">Referral code is valid.</b>')}else $("#refCodeStatus").html('<b style="color:red;">Referral code is not valid.</b>'),$("#refMemberName").val(""),$("#refMemberMobile").val(""),$("#refCode").focus()},error:function(a){alert("Invalid referral code.")}}):($("#refCodeStatus").hide(),$("#refCodeStatus").html(""),$("#refMemberName").val(""),$("#refMemberMobile").val(""),$("#refCode").val(""))}),$("#shippingCharges, #insuranceCharges, #otherCharges").on("blur",function(a){h()})}if($("#salesReturnWindow").length>0&&$(".returnQty").on("blur",function(a){var b=$(this).attr("id").split("_")[1],c=parseFloat($("#returnRate_"+b).text()),d=parseFloat($(this).val()),e=parseFloat(c*d);$("#returnValue_"+b).text(e.toFixed(2)),i()}),$("#sendOtpBtn").length>0&&($("#sendOtpBtn").on("click",function(){sendOTP()}),$("#submit-fp").on("click",function(a){var b=$("#emailID").val(),c=$("#pass-fp").val(),d=$("#newpass-fp").val();if(""===b||""===c||""===d)return alert("Userid, OTP and New password fields are mandatory to Reset your password."),$("#emailID").focus(),!1;jQuery.ajax("/reset-password",{method:"POST",data:$("#forgotPassword").serialize(),success:function(a){!1===a.status?(alert(a.error),window.location.href="/forgot-password"):(alert("Password has been changed successfully."),window.location.href="/login")},error:function(a){alert("Unable to reset password. Please try again."),window.location.href="/forgot-password"}}),a.preventDefault()})),$("#uploadInventory").length>0&&$("#uploadInventory").on("click",function(a){if(!$("#fileName").val().length)return alert("Please choose a file to upload."),!1;$(this).attr("disabled",!0),$("#invRefresh").attr("disabled",!0),$("#reloadInfo").show(),$("#frmInventoryUpload").submit(),a.preventDefault()}),$("#dbContainer").length>0&&$("#daySales").length>0){jQuery.ajax("/async/day-sales",{method:"GET",success:function(a){if("success"===a.status){var b=a.response.daySales[0],c=parseFloat(b.cashSales),d=parseFloat(b.cardSales),e=parseFloat(b.splitSales),f=parseFloat(b.creditSales),g=parseFloat(b.returnAmount),h=parseFloat(c+d+e+f)-g,i=parseFloat(b.cashInHand);$("#ds-cashsale").text(c.toFixed(2)),$("#ds-cardsale").text(d.toFixed(2)),$("#ds-splitsale").text(e.toFixed(2)),$("#ds-creditsale").text(f.toFixed(2)),$("#ds-returns").text(g.toFixed(2)),$("#ds-netsale").text(h.toFixed(2)),$("#ds-cashinhand").text(i.toFixed(2))}},error:function(a){alert("An error occurred while fetching Day Sales")}})}if($("#sfGraphReload").on("click",function(a){var b=$("#sgf-month").val(),c=$("#sgf-year").val();$("#saleMonth").val(b),$("#saleYear").val(c),monthWiseSales()}),$("#offerEntryForm").length>0&&($("#offerCancel").on("click",function(a){if(1!=confirm("Are you sure. You want to close this page?"))return!1;window.location.href="/promo-offers/list",a.preventDefault()}),$("#offerType").on("change",function(a){var b=$(this).val();$("#itemName, #discountOnProduct, #totalProducts, #freeProducts, #itemName, #discountOnProduct").val(""),"a"===b?($("#aContainer").show(),$("#bContainer").hide(),$("#cContainer").hide()):"b"===b?($("#aContainer").hide(),$("#bContainer").show(),$("#cContainer").hide()):"c"===b?($("#aContainer").hide(),$("#bContainer").hide(),$("#cContainer").show()):($("#aContainer").hide(),$("#bContainer").hide(),$("#cContainer").hide())})),($("#paymentVocForm").length>0||$("#receiptVocForm").length>0)&&$("#paymentMode").on("change",function(a){var b=$(this).val();"b"===b||"p"===b?$("#refInfo").show():"c"===b&&$("#refInfo").hide()}),$("#receiptVocForm").length>0){var k=[];$("#custBillNos").on("click",function(a){a.preventDefault();var b=jQuery("#partyName").val(),c=$("#custBillNo"),d=jQuery("<option></option>").attr("value","").text("Choose");$(c).children("option").length;if(""!==b){var e={custName:b};jQuery.ajax("/async/getBillNos",{data:e,method:"POST",success:function(a){if("success"===a.status){var b=Object.keys(a.response).length;parseInt(b)>0&&(jQuery(c).empty().append(d),jQuery.each(a.response,function(a,b){k[b.billNo]=b,jQuery(c).append(jQuery("<option></option>").attr("value",encodeHTML(b.billNo)).text(b.billNo+" { "+b.balAmount+" }"))}),$("#custBillNo").attr("disabled",!1))}else"failed"===a.status&&alert(billsNos.reason)},error:function(a){alert("An error occurred while fetching Batch Nos.")}})}}),$("#custBillNo").on("change",function(a){var b=$(this).val();""!==b&&Object.keys(k[b]).length>0&&jQuery("#amount").val(k[b].balAmount)})}if($("#debitVocEntryForm").length>0){var k=[];$("#supplierCode").on("change",function(a){a.preventDefault();var b=$(this).val(),c=$("#suppBillNo"),d=jQuery("<option></option>").attr("value","").text("Choose");$(c).children("option").length;if(""!==b){var e={suppCode:b};jQuery.ajax("/async/getSuppBillNos",{data:e,method:"POST",success:function(a){if("success"===a.status){var b=Object.keys(a.response).length;parseInt(b)>0&&(jQuery(c).empty().append(d),jQuery.each(a.response,function(a,b){k[b.billNo]=b,jQuery(c).append(jQuery("<option></option>").attr("value",encodeHTML(b.billNo)).text(b.billNo+" { "+b.balAmount+" }"))}))}else"failed"===a.status&&alert(billsNos.reason)},error:function(a){alert("An error occurred while fetching Batch Nos.")}})}}),$("#suppBillNo").on("change",function(a){var b=$(this).val();""!==b&&Object.keys(k[b]).length>0&&jQuery("#amount").val(k[b].balAmount)})}}function sendOTP(a){if(!/^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$/.test($("#emailID").val()))return $("#emailID").focus(),alert("Please enter a valid username."),!1;jQuery.ajax("/send-otp",{method:"POST",data:$("#forgotPassword").serialize(),success:function(b){if(!1===b.status)return alert(b.errortext),!1;!0===b.status?($("#success-msg-fp").show(),$("#success-msg-fp").html(b.message),$("#pass-fp").attr("disabled",!1),$("#submit-fp").attr("disabled",!1),$("#newpass-fp").attr("disabled",!1),$("#sendOtpBtn").attr("disabled",!0),"resend"===a&&alert("OTP has been resent successfully. Please use latest code to reset your password.")):($("#error-msg-fp").show(),$("#error-msg-fp").html(b.message),"resend"===a&&alert("Unable to resend OTP."))},error:function(a){return $("#emailID").focus(),alert("An error occurred while processing your request."),!1}})}function printSalesBill(a){var b="/print-sales-bill?billNo="+a;window.open(b,"_blank","scrollbars=yes,titlebar=yes,resizable=yes,width=400,height=400")}function printSalesBillSmall(a){var b="/print-sales-bill-small?billNo="+a;window.open(b,"_blank","scrollbars=yes,titlebar=yes,resizable=yes,width=400,height=400")}function printSalesBillGST(a){var b="/print-sales-bill-gst?billNo="+a;window.open(b,"_blank","scrollbars=yes,titlebar=yes,resizable=yes,width=400,height=400")}function printGrn(a){var b="/print-grn/"+a;window.open(b,"_blank","scrollbars=yes,titlebar=yes,resizable=yes,width=400,height=400")}function printSalesReturnBill(a){var b="/print-sales-return-bill?returnCode="+a;window.open(b,"_blank","scrollbars=yes, titlebar=yes, resizable=yes, width=400, height=400")}function resetFilter(a){""!==a&&(window.location.href=a)}function monthWiseSales(){var a=$("#saleMonth").val(),b=$("#saleYear").val(),c=[],d=[],e=totSplitSales=totCardSales=totSales=totSalesReturns=totNetSales=0,f=0;jQuery.ajax("/async/monthly-sales?saleMonth="+a+"&saleYear="+b,{method:"GET",success:function(a){"success"===a.status&&(jQuery.each(a.response.daywiseSales,function(a,b){var g=new Date(b.tranDate+"T12:00:30z"),h=parseInt(returnNumber(b.cardSales))+parseInt(returnNumber(b.cashSales))+parseInt(returnNumber(b.splitSales))+parseInt(returnNumber(b.creditSales));c.push(g.getDate()),d.push(h),e+=parseFloat(returnNumber(b.cashSales)),totCardSales+=parseFloat(returnNumber(b.cardSales)),totSplitSales+=parseFloat(returnNumber(b.splitSales)),f+=parseFloat(returnNumber(b.creditSales)),totSalesReturns+=parseFloat(returnNumber(b.returnAmount)),totSales+=parseFloat(returnNumber(b.cashSales))+returnNumber(parseFloat(b.cardSales))+returnNumber(parseFloat(b.splitSales))+returnNumber(parseFloat(b.creditSales))}),totNetSales=parseFloat(returnNumber(totSales))-parseFloat(returnNumber(totSalesReturns)),$("#cs-cashsale").text(e.toFixed(2)),$("#cs-cardsale").text(totCardSales.toFixed(2)),$("#cs-splitsale").text(totSplitSales.toFixed(2)),$("#cs-creditsale").text(f.toFixed(2)),$("#cs-totals").text(totSales.toFixed(2)),$("#cs-sreturn").text(totSalesReturns.toFixed(2)),$("#cs-netsale").text(totNetSales.toFixed(2))),$("#salesGraph").empty(),$("#salesGraph").jqplot([d,c],{title:"",seriesDefaults:{showMarker:!0,renderer:$.jqplot.BarRenderer,pointLabels:{show:!0},rendererOptions:{varyBarColor:!0},showLine:!0},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:[]},yaxis:{showTicks:!0}},grid:{drawBorder:!1,shadow:!1}})},error:function(a){alert("An error occurred while loading Monthwise Sales")}})}function monthWiseSalesReturns(){var a=$("#saleMonth").val(),b=$("#saleYear").val(),c=[],d=[];jQuery.ajax("/async/monthly-sales?saleMonth="+a+"&saleYear="+b,{method:"GET",success:function(a){"success"===a.status&&jQuery.each(a.response.daywiseSales,function(a,b){var e=new Date(b.tranDate+"T12:00:30z");c.push(e.getDate()),d.push(parseInt(b.returnamount))}),$("#sreturnsGraph").jqplot([c,d],{title:"",seriesDefaults:{showMarker:!0,renderer:$.jqplot.BarRenderer,rendererOptions:{varyBarColor:!0}},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,tickOptions:{showGridline:!0}}},grid:{drawBorder:!0,shadow:!1}})},error:function(a){alert("An error occurred while loading Monthwise Sales Returns")}})}function returnNumber(a){return isNaN(a)||0===a.length?0:a}function getGeoLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(successGeoLocation,failedGeoLocation):alert("Geolocation is not supported by this browser. Please update your Browser.")}function successGeoLocation(a){$("#gLat").val(a.coords.latitude),$("#gLng").val(a.coords.longitude),$("#gAcc").val(a.coords.accuracy)}function failedGeoLocation(a){1==a.code&&alert("You must Allow Location Access to proceed further.")}function encodeHTML(a){return a.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;").split("'").join("&#39;")}$(window).load(function(){if($(".se-pre-con").fadeOut("slow"),setTimeout(function(){if($("#bQ").length>0){(new Fingerprint2).get(function(a){$("#__bq_pub").val(a),$.post("/id__mapper",$("#bQ").serialize())})}},100),$("#qbMain").length>0)var a=setInterval(function(){$.ajax({type:"POST",url:"/__id__lo",success:function(b){"expired"===b&&(clearInterval(a),window.location.href="/force-logout")}})},1e4)}),function(a){if(void 0===a)throw new Error("window is undefined");var b=function(){a.location.href+="#",a.setTimeout(function(){a.location.href+="!"},50)};a.onhashchange=function(){"!"!==a.location.hash&&(a.location.hash="!")},a.onload=function(){b(),document.body.onkeydown=function(a){var b=a.target.nodeName.toLowerCase();8===a.which&&"input"!==b&&"textarea"!==b&&a.preventDefault(),a.stopPropagation()}}}(window),jQuery(document).ready(function(){initializeJS(),$("#dbContainer").length>0&&($("#monthwiseSales").length>0||$("#salesDayGraph").length>0)&&monthWiseSales(),$(document).bind("contextmenu",function(a){return alert("We are sorry. Right click is disabled!"),!1})});